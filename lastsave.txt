
R version 3.3.0 (2016-05-03) -- "Supposedly Educational"
Copyright (C) 2016 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> utils:::menuInstallPkgs()
--- Please select a CRAN mirror for use in this session ---
also installing the dependencies ‘RJSONIO’, ‘maps’, ‘sp’, ‘proto’, ‘RgoogleMaps’, ‘png’, ‘rjson’, ‘mapproj’, ‘jpeg’, ‘geosphere’

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/RJSONIO_1.3-0.zip'
Content type 'application/zip' length 1507188 bytes (1.4 MB)
downloaded 1.4 MB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/maps_3.1.0.zip'
Content type 'application/zip' length 3612322 bytes (3.4 MB)
downloaded 3.4 MB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/sp_1.2-3.zip'
Content type 'application/zip' length 1572941 bytes (1.5 MB)
downloaded 1.5 MB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/proto_0.3-10.zip'
Content type 'application/zip' length 458550 bytes (447 KB)
downloaded 447 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/RgoogleMaps_1.2.0.7.zip'
Content type 'application/zip' length 714521 bytes (697 KB)
downloaded 697 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/png_0.1-7.zip'
Content type 'application/zip' length 289124 bytes (282 KB)
downloaded 282 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/rjson_0.2.15.zip'
Content type 'application/zip' length 561827 bytes (548 KB)
downloaded 548 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/mapproj_1.2-4.zip'
Content type 'application/zip' length 80805 bytes (78 KB)
downloaded 78 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/jpeg_0.1-8.zip'
Content type 'application/zip' length 227899 bytes (222 KB)
downloaded 222 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/geosphere_1.5-1.zip'
Content type 'application/zip' length 893797 bytes (872 KB)
downloaded 872 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/ggmap_2.6.1.zip'
Content type 'application/zip' length 4559915 bytes (4.3 MB)
downloaded 4.3 MB

package ‘RJSONIO’ successfully unpacked and MD5 sums checked
package ‘maps’ successfully unpacked and MD5 sums checked
package ‘sp’ successfully unpacked and MD5 sums checked
package ‘proto’ successfully unpacked and MD5 sums checked
package ‘RgoogleMaps’ successfully unpacked and MD5 sums checked
package ‘png’ successfully unpacked and MD5 sums checked
package ‘rjson’ successfully unpacked and MD5 sums checked
package ‘mapproj’ successfully unpacked and MD5 sums checked
package ‘jpeg’ successfully unpacked and MD5 sums checked
package ‘geosphere’ successfully unpacked and MD5 sums checked
package ‘ggmap’ successfully unpacked and MD5 sums checked

The downloaded binary packages are in
        C:\Users\User\AppData\Local\Temp\RtmpItdKfO\downloaded_packages
> library(ggplot2)
> library(ggmap)
Google Maps API Terms of Service: http://developers.google.com/maps/terms.
Please cite ggmap if you use it: see citation('ggmap') for details.
> map <- 
+     readRDS("../input/sf_map_copyright_openstreetmap_contributors.rds")
Error in gzfile(file, "rb") : cannot open the connection
In addition: Warning message:
In gzfile(file, "rb") :
  cannot open compressed file '../input/sf_map_copyright_openstreetmap_contributors.rds', probable reason 'No such file or directory'
> 
> ggmap(map, extent='device', legend="topleft") +
+ geom_point(aes(x=X, y=Y, colour=Category), data=mapdata ) +  
+ ggtitle('Violent Crime in San Francisco')
Error in ggmap(map, extent = "device", legend = "topleft") : 
  object 'map' not found
> mapdata <-
+     train %>%
+     filter(Category %in% c("ASSAULT", "ROBBERY", "SEX OFFENSES FORCIBLE"))
Error: could not find function "%>%"
> 
> mapdata %>%
+ group_by(Category) %>%
+ summarise(n=n())
Error: could not find function "%>%"
> utils:::menuInstallPkgs()
also installing the dependencies ‘assertthat’, ‘R6’, ‘lazyeval’, ‘DBI’, ‘BH’

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/assertthat_0.1.zip'
Content type 'application/zip' length 44762 bytes (43 KB)
downloaded 43 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/R6_2.1.2.zip'
Content type 'application/zip' length 271176 bytes (264 KB)
downloaded 264 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/lazyeval_0.1.10.zip'
Content type 'application/zip' length 62476 bytes (61 KB)
downloaded 61 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/DBI_0.4-1.zip'
Content type 'application/zip' length 207815 bytes (202 KB)
downloaded 202 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/BH_1.60.0-2.zip'
Content type 'application/zip' length 15529281 bytes (14.8 MB)
downloaded 14.8 MB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/dplyr_0.4.3.zip'
Content type 'application/zip' length 2393439 bytes (2.3 MB)
downloaded 2.3 MB

package ‘assertthat’ successfully unpacked and MD5 sums checked
package ‘R6’ successfully unpacked and MD5 sums checked
package ‘lazyeval’ successfully unpacked and MD5 sums checked
package ‘DBI’ successfully unpacked and MD5 sums checked
package ‘BH’ successfully unpacked and MD5 sums checked
package ‘dplyr’ successfully unpacked and MD5 sums checked

The downloaded binary packages are in
        C:\Users\User\AppData\Local\Temp\RtmpItdKfO\downloaded_packages
> utils:::menuInstallPkgs()
Error in install.packages(NULL, .libPaths()[1L], dependencies = NA, type = type) : 
  no packages were specified
> utils:::menuInstallPkgs()
also installing the dependency ‘curl’

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/curl_0.9.7.zip'
Content type 'application/zip' length 4394266 bytes (4.2 MB)
downloaded 4.2 MB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/readr_0.2.2.zip'
Content type 'application/zip' length 1018551 bytes (994 KB)
downloaded 994 KB

package ‘curl’ successfully unpacked and MD5 sums checked
package ‘readr’ successfully unpacked and MD5 sums checked

The downloaded binary packages are in
        C:\Users\User\AppData\Local\Temp\RtmpItdKfO\downloaded_packages
> utils:::menuInstallPkgs()
trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/lubridate_1.5.6.zip'
Content type 'application/zip' length 662265 bytes (646 KB)
downloaded 646 KB

package ‘lubridate’ successfully unpacked and MD5 sums checked

The downloaded binary packages are in
        C:\Users\User\AppData\Local\Temp\RtmpItdKfO\downloaded_packages
> library(dplyr)

Attaching package: ‘dplyr’

The following objects are masked from ‘package:stats’:

    filter, lag

The following objects are masked from ‘package:base’:

    intersect, setdiff, setequal, union

> library(readr)
> library(lubridate)

Attaching package: ‘lubridate’

The following object is masked from ‘package:base’:

    date

> 
> coltypes <-
+     list(Dates = col_datetime("%Y-%m-%d %H:%M:%S"))
> 
> train <-
+     read_csv(file="../input/train.csv",
+                   col_types=coltypes)
Error: '../input/train.csv' does not exist in current working directory ('C:/Users/User/Documents/University Book/Miscellaneous/Calon Asisten/Basdat/Tugas 2').
> test <-
+     read_csv(file="../input/test.csv",
+                   col_types=coltypes) 
Error: '../input/test.csv' does not exist in current working directory ('C:/Users/User/Documents/University Book/Miscellaneous/Calon Asisten/Basdat/Tugas 2').
> 
> train <-
+     train %>%
+     mutate(Year  = factor(year(Dates), levels=2003:2015),
+            Month = factor(month(Dates), levels=1:12),
+            Day   = day(Dates),
+            Hour  = factor(hour(Dates), levels=0:23),
+            dayDate = as.POSIXct(round(Dates, units = "days")),
+            DayOfWeek = factor(DayOfWeek, levels=c("Monday",
+                                                   "Tuesday",
+                                                   "Wednesday",
+                                                   "Thursday",
+                                                   "Friday",
+                                                   "Saturday",
+                                                   "Sunday"))
+            )
Error: ‘round’ not meaningful for factors
>            
> unique(train$Category)
 [1] WARRANTS                    OTHER OFFENSES             
 [3] LARCENY/THEFT               VEHICLE THEFT              
 [5] VANDALISM                   NON-CRIMINAL               
 [7] ROBBERY                     ASSAULT                    
 [9] WEAPON LAWS                 BURGLARY                   
[11] SUSPICIOUS OCC              DRUNKENNESS                
[13] FORGERY/COUNTERFEITING      DRUG/NARCOTIC              
[15] STOLEN PROPERTY             SECONDARY CODES            
[17] TRESPASS                    MISSING PERSON             
[19] FRAUD                       KIDNAPPING                 
[21] RUNAWAY                     DRIVING UNDER THE INFLUENCE
[23] SEX OFFENSES FORCIBLE       PROSTITUTION               
[25] DISORDERLY CONDUCT          ARSON                      
[27] FAMILY OFFENSES             LIQUOR LAWS                
[29] BRIBERY                     EMBEZZLEMENT               
[31] SUICIDE                     LOITERING                  
[33] SEX OFFENSES NON FORCIBLE   EXTORTION                  
[35] GAMBLING                    BAD CHECKS                 
[37] TREA                        RECOVERED VEHICLE          
[39] PORNOGRAPHY/OBSCENE MAT    
39 Levels: ARSON ASSAULT BAD CHECKS BRIBERY BURGLARY ... WEAPON LAWS
> mapdata <-
+     train %>%
+     filter(Category %in% c("ASSAULT", "ROBBERY", "SEX OFFENSES FORCIBLE"))
> 
> mapdata %>%
+ group_by(Category) %>%
+ summarise(n=n())
Source: local data frame [3 x 2]

               Category     n
                 (fctr) (int)
1               ASSAULT 76876
2               ROBBERY 23000
3 SEX OFFENSES FORCIBLE  4388
> library(ggplot2)
> library(ggmap)
> map <- 
+     readRDS("../input/sf_map_copyright_openstreetmap_contributors.rds")
Error in gzfile(file, "rb") : cannot open the connection
In addition: Warning message:
In gzfile(file, "rb") :
  cannot open compressed file '../input/sf_map_copyright_openstreetmap_contributors.rds', probable reason 'No such file or directory'
> 
> ggmap(map, extent='device', legend="topleft") +
+ geom_point(aes(x=X, y=Y, colour=Category), data=mapdata ) +  
+ ggtitle('Violent Crime in San Francisco')
Error in ggmap(map, extent = "device", legend = "topleft") : 
  object 'map' not found
> map <- 
+     readRDS("../input/sf_map_copyright_openstreetmap_contributors.rds")
Error in gzfile(file, "rb") : cannot open the connection
In addition: Warning message:
In gzfile(file, "rb") :
  cannot open compressed file '../input/sf_map_copyright_openstreetmap_contributors.rds', probable reason 'No such file or directory'
> 
> ggmap(map, extent='device', legend="topleft") +
+ geom_point(aes(x=X, y=Y, colour=Category), data=mapdata ) +  
+ ggtitle('Violent Crime in San Francisco')
Error in ggmap(map, extent = "device", legend = "topleft") : 
  object 'map' not found
> map <- 
+     readRDS("../input/sf_map_copyright_openstreetmap_contributors.rds")
Error in gzfile(file, "rb") : cannot open the connection
In addition: Warning message:
In gzfile(file, "rb") :
  cannot open compressed file '../input/sf_map_copyright_openstreetmap_contributors.rds', probable reason 'No such file or directory'
> 
> ggmap(map, extent='device', legend="topleft") +
+ geom_point(aes(x=X, y=Y, colour=Category), data=mapdata ) +  
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ 
+ q
Error in ggmap(map, extent = "device", legend = "topleft") : 
  object 'map' not found
> map <-
+ readRDS("sf_map_copyright_openstreetmap_contributors.rds")
Error in readRDS("sf_map_copyright_openstreetmap_contributors.rds") : 
  unknown input format
> saveRDS(sf,"sf_map_copyright_openstreetmap_contributors.txt")
Error in saveRDS(sf, "sf_map_copyright_openstreetmap_contributors.txt") : 
  object 'sf' not found
> sf <- 1:5
> saveRDS(sf,"sf_map_copyright_openstreetmap_contributors.txt")
> readRDS("sf_map_copyright_openstreetmap_contributors.rds")
Error in readRDS("sf_map_copyright_openstreetmap_contributors.rds") : 
  unknown input format
> map <- 
+ readRDS("sf_map_copyright_openstreetmap_contributors.rds")
Error in readRDS("sf_map_copyright_openstreetmap_contributors.rds") : 
  unknown input format
> map <-
+ readRDS(sf
+ )
Error in readRDS(sf) : bad 'file' argument
> sf <- 1:90000
> saveRDS(sf,"sf_map_copyright_openstreetmap_contributors.txt")
> saveRDS(sf,file="sf_map_copyright_openstreetmap_contributors.txt")
> map <-
+ readRDS("sf_map_copyright_openstreetmap_contributors.rds")
Error in readRDS("sf_map_copyright_openstreetmap_contributors.rds") : 
  unknown input format
> saveRDS(sf,"sf_map_copyright_openstreetmap_contributors.rds")
> map <-
+ readRDS("sf_map_copyright_openstreetmap_contributors.rds")
> ggmap(map, extent='device', legend="topleft") +
+ geom_point(aes(x=X, y=Y, colour=Category), data=mapdata ) +  
+ ggtitle('Violent Crime in San Francisco')
Error: ggmap plots objects of class ggmap, see ?get_map
> ggmap(map, extent='device', legend="topleft")
Error: ggmap plots objects of class ggmap, see ?get_map
> ggmap(map, extent='device', legend="topleft") +
+ geom_point(aes(x=X, y=Y, colour=Category), data=mapdata ) +  
+ 
+ q
Error: ggmap plots objects of class ggmap, see ?get_map
> ggmap(map, extent='device', legend="topleft")
Error: ggmap plots objects of class ggmap, see ?get_map
> ?get_map
starting httpd help server ... done
> utils:::menuInstallPkgs()
trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/RColorBrewer_1.1-2.zip'
Content type 'application/zip' length 26676 bytes (26 KB)
downloaded 26 KB

package ‘RColorBrewer’ successfully unpacked and MD5 sums checked

The downloaded binary packages are in
        C:\Users\User\AppData\Local\Temp\RtmpItdKfO\downloaded_packages
> utils:::menuInstallPkgs()
also installing the dependencies ‘jsonlite’, ‘yaml’, ‘mime’, ‘base64enc’, ‘htmlwidgets’, ‘htmltools’, ‘markdown’, ‘raster’

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/jsonlite_0.9.21.zip'
Content type 'application/zip' length 1095147 bytes (1.0 MB)
downloaded 1.0 MB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/yaml_2.1.13.zip'
Content type 'application/zip' length 175741 bytes (171 KB)
downloaded 171 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/mime_0.4.zip'
Content type 'application/zip' length 37402 bytes (36 KB)
downloaded 36 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/base64enc_0.1-3.zip'
Content type 'application/zip' length 38387 bytes (37 KB)
downloaded 37 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/htmlwidgets_0.6.zip'
Content type 'application/zip' length 843475 bytes (823 KB)
downloaded 823 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/htmltools_0.3.5.zip'
Content type 'application/zip' length 572292 bytes (558 KB)
downloaded 558 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/markdown_0.7.7.zip'
Content type 'application/zip' length 164970 bytes (161 KB)
downloaded 161 KB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/raster_2.5-8.zip'
Content type 'application/zip' length 3144751 bytes (3.0 MB)
downloaded 3.0 MB

trying URL 'https://cloud.r-project.org/bin/windows/contrib/3.3/leaflet_1.0.1.zip'
Content type 'application/zip' length 473987 bytes (462 KB)
downloaded 462 KB

package ‘jsonlite’ successfully unpacked and MD5 sums checked
package ‘yaml’ successfully unpacked and MD5 sums checked
package ‘mime’ successfully unpacked and MD5 sums checked
package ‘base64enc’ successfully unpacked and MD5 sums checked
package ‘htmlwidgets’ successfully unpacked and MD5 sums checked
package ‘htmltools’ successfully unpacked and MD5 sums checked
package ‘markdown’ successfully unpacked and MD5 sums checked
package ‘raster’ successfully unpacked and MD5 sums checked
package ‘leaflet’ successfully unpacked and MD5 sums checked

The downloaded binary packages are in
        C:\Users\User\AppData\Local\Temp\RtmpItdKfO\downloaded_packages
> train.map <- function(categories, n) {
+ new.crimes <- filter(train, Category %in% categories) %>% droplevels()
+ pal <- colorFactor(brewer.pal(length(unique(new.crimes$Category)), "Set1"), domain=new.crimes$Category)
+ leaflet(new.crimes[1:n,]) %>%
+ addProviderTiles("CartoDB.Positron") %>% 
+         addCircleMarkers (lng =  ~X, lat =  ~Y, 
+                           color = ~pal(Category),
+                           opacity = .7, radius  = 1) %>%  
+         addLegend(pal = pal, values = new.crimes$Category)
+ }
> train.map(c("SEX OFFENSES FORCIBLE", "PROSTITUTION","DRUNKENNESS"), n = 1000)
Error in train.map(c("SEX OFFENSES FORCIBLE", "PROSTITUTION", "DRUNKENNESS"),  : 
  could not find function "colorFactor"
> library(RColorBrewer)
> library(leaflet)
> 
> library(dplyr)
> train.map <- function(categories, n) {
+ q
+ )
Error: unexpected ')' in:
"q
)"
> train.map <- function(categories, n) {
+ + new.crimes <- filter(train, Category %in% categories) %>% droplevels()
+ + pal <- colorFactor(brewer.pal(length(unique(new.crimes$Category)), "Set1"), domain=new.crimes$Category)
+ + leaflet(new.crimes[1:n,]) %>%
+ + addProviderTiles("CartoDB.Positron") %>% 
+ +         addCircleMarkers (lng =  ~X, lat =  ~Y, 
+ +                           color = ~pal(Category),
Error: unexpected '=' in:
"+         addCircleMarkers (lng =  ~X, lat =  ~Y, 
+                           color ="
> +                           opacity = .7, radius  = 1) %>%  
Error: unexpected ',' in "+                           opacity = .7,"
> +         addLegend(pal = pal, values = new.crimes$Category)
Error in inherits(values, "formula") : object 'new.crimes' not found
> + }
Error: unexpected '}' in "+ }"
> train.map <- function(categories, n) {
+ + new.crimes <- filter(train, Category %in% categories) %>% droplevels()
+ addProviderTiles("CartoDB.Positron") %>% 
+ q
+ q
+ )
Error: unexpected ')' in:
"q
)"
> train.map <- function(categories,n){
+ new.trains <- filter(crimes, Category %in% categories) %>% droplevels()
+ pal <- colorFactor(brewer.pal(length(unique(new.trains$Category)), "Set1"), domain = new.trains$Category)
+ leaflet(new.trains[1:n,]) %>%
+ addProviderTiles("CartoDB.Positron") %>% 
+         addCircleMarkers (lng =  ~X, lat =  ~Y, 
+                           color = ~pal(Category),
+                           opacity = .7, radius  = 1) %>%  
+         addLegend(pal = pal, values = new.crimes$Category)
+ }
> train.map(c("SEX OFFENSES FORCIBLE", "PROSTITUTION","DRUNKENNESS"), n = 1000)
Error in filter_(.data, .dots = lazyeval::lazy_dots(...)) : 
  object 'crimes' not found
> train.map <- function(categories,n){
+ new.trains <- filter(train, Category %in% categories) %>% droplevels()
+ q
+ )
Error: unexpected ')' in:
"q
)"
> trains.map <- function(categories, n) {
+ new.train <- filter(train, Category %in% categories) %>% droplevels()
+ pal <- colorFactor(brewer.pal(length(unique(new.crimes$Category)), "Set1"),
+                        domain = new.crimes$Category)
+ q
+ )
Error: unexpected ')' in:
"q
)"
> trains.map <- function(categories, n) {
+ new.train <- filter(train, Category %in% categories) %>% droplevels()
+ pal <- colorFactor(brewer.pal(length(unique(new.train$Category)), "Set1"), domain = new.train$Category)
+ leaflet(new.train[1:n,]) %>%
+ addProviderTiles("CartoDB.Positron") %>% 
+ addCircleMarkers (lng =  ~X, lat =  ~Y, 
+                           color = ~pal(Category),
+                           opacity = .7, radius  = 1) %>% 
+ addLegend(pal=pal, values = new.train$category)
+ }
> train.map(c("SEX OFFENSES FORCIBLE", "PROSTITUTION","DRUNKENNESS"), n = 1000)
Error in filter_(.data, .dots = lazyeval::lazy_dots(...)) : 
  object 'crimes' not found
> trains.map(c("SEX OFFENSES FORCIBLE", "PROSTITUTION","DRUNKENNESS"), n = 1000)
Warning messages:
1: In is.na(object) :
  is.na() applied to non-(list or vector) of type 'NULL'
2: In is.na(x) : is.na() applied to non-(list or vector) of type 'NULL'
3: In is.na(values) :
  is.na() applied to non-(list or vector) of type 'NULL'
> trains.map(c("SEX OFFENSES FORCIBLE", "PROSTITUTION","DRUNKENNESS"), n = 1000)
Warning messages:
1: In is.na(object) :
  is.na() applied to non-(list or vector) of type 'NULL'
2: In is.na(x) : is.na() applied to non-(list or vector) of type 'NULL'
3: In is.na(values) :
  is.na() applied to non-(list or vector) of type 'NULL'
> addLegend(pal=pal, values = new.train$category)
